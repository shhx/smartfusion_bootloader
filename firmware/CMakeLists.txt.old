cmake_minimum_required(VERSION 3.10)
# project(Firmware)

# Collect all source files recursively
file(GLOB_RECURSE FIRMWARE_SOURCES 
    "${CMAKE_CURRENT_SOURCE_DIR}/CMSIS/*.c"
    "${CMAKE_CURRENT_SOURCE_DIR}/CMSIS/*.S"
    "${CMAKE_CURRENT_SOURCE_DIR}/drivers/**/*.c"
    "${CMAKE_CURRENT_SOURCE_DIR}/drivers_config/**/*.c"
    "${CMAKE_CURRENT_SOURCE_DIR}/hal/**/*.c"
    "${CMAKE_CURRENT_SOURCE_DIR}/hal/**/*.S"
)

file(GLOB_RECURSE FIRMWARE_ASMSOURCES 
    "${CMAKE_CURRENT_SOURCE_DIR}/CMSIS/startup_gcc/*.S"
    "${CMAKE_CURRENT_SOURCE_DIR}/CMSIS/*.s"
    "${CMAKE_CURRENT_SOURCE_DIR}/hal/**/*.s"
)

# Add include directories
include_directories(${CMAKE_CURRENT_SOURCE_DIR})

# Make sources and includes available to the parent project
set(FIRMWARE_SOURCES ${FIRMWARE_SOURCES} ${FIRMWARE_ASMSOURCES} PARENT_SCOPE)
set(FIRMWARE_INCLUDES ${FIRMWARE_INCLUDES} PARENT_SCOPE)

# include_directories(.)

# # Source files
# file(GLOB_RECURSE FW_SOURCES
#     ${CMAKE_SOURCE_DIR}/${FIRMWARE_DIR}/hal/CortexM3/*.c
#     ${CMAKE_SOURCE_DIR}/${FIRMWARE_DIR}/drivers/**/*.c
#     ${CMAKE_SOURCE_DIR}/${FIRMWARE_DIR}/CMSIS/startup_gcc/*.c
#     ${CMAKE_SOURCE_DIR}/${FIRMWARE_DIR}/drivers_config/**/*.c
#     ${CMAKE_SOURCE_DIR}/${FIRMWARE_DIR}/*.c
# )

# file(GLOB_RECURSE FW_ASMSOURCES
#     ${CMAKE_SOURCE_DIR}/${FIRMWARE_DIR}/CMSIS/startup_gcc/*.S
#     ${CMAKE_SOURCE_DIR}/${FIRMWARE_DIR}/hal/CortexM3/*.s
#     ${CMAKE_SOURCE_DIR}/${FIRMWARE_DIR}/CMSIS/**/*.s
# )

# target_sources(${TARGET_NAME} PRIVATE ${FW_SOURCES} ${FW_ASMSOURCES})
